<div *ngIf="alerts$ | async as alerts">
  <h2>Alertas ({{ alerts.length }})</h2>

  <button mat-button (click)="markAllAsRead()">Marcar todas como leídas</button>

  <mat-card
    *ngFor="let alert of alerts"
    class="alert-card"
    [ngClass]="alert.level"
  >
    <mat-card-header>
      <mat-icon *ngIf="alert.level === 'critical'">error</mat-icon>
      <mat-icon *ngIf="alert.level === 'warning'">warning</mat-icon>
      <mat-card-title>{{ alert.level.toUpperCase() }}</mat-card-title>
      <mat-card-subtitle>
        {{ alert.createdAt | date : "short" }}
      </mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <p>{{ alert.message }}</p>
    </mat-card-content>

    <mat-card-actions>
      <button mat-button color="primary" (click)="goToSensor(alert)">
        Ver sensor
      </button>
      <span *ngIf="!alert.isRead" class="badge-unread">● No leída</span>
    </mat-card-actions>
    <hr />
  </mat-card>
</div>
